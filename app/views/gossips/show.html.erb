<% user = @gossip.user%>


<div class="container my-5">
  <div class="text-start" ><%= link_to 'Retour', root_path, class: "btn btn-secondary" %></div>
  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <div>
        <strong>Auteur :</strong>
        <%= link_to "#{user.first_name} #{user.last_name}", user_path(user_id: user, gossip_id: @gossip), class: "text-white text-decoration-underline" %>
      </div>
      <div> 
        <%= link_to 'Modifier le potin', edit_gossip_path(@gossip), class: "btn btn-warning" %>
      </div>
      <div> 
        <%= button_to 'Supprimer le potin', gossip_path(@gossip), method: :delete, data: { confirm: "Es-tu sûr ?"}, class: "btn btn-danger"%>
      </div>
      <div>
        <strong>Ville :</strong>
        <%= link_to user.city.name, city_path(user.city), class: "text-white text-decoration-underline" %>
      </div>
    </div>

    <div class="card-body">
      <h1 class="card-title display-5 mb-4"><%= @gossip.title %></h1>
      <p class="card-text fs-5"><%= simple_format(@gossip.content) %></p>
    </div>

    <div class="card-footer text-muted text-end">
      
      <% @gossip.tags.each do |tag| %>
        <span><%= "#{tag.title}" %></span>
      <% end %>
      
      <div>Créé le <%= @gossip.created_at.strftime("%d/%m/%Y à %Hh%M") %></div>
    </div>
  </div>


  <h2 class= "text-center">Commentaires</h2>
  
  <%= form_with model: [@gossip, Comment.new], local: true do |f| %>
    <div class="col-12">
      <%= f.text_area :content, class: "form-control", rows: 2 %>
      <div class="text-end mt-2">
        <%= f.submit "Ajouter", class: "btn btn-secondary" %>
      </div>
    </div>
  <% end %>
  <% @gossip.comments.each do |comment|%>
  <% sender = comment.user%>
    <div>
      <div>
        <p><%= "#{sender.first_name} #{sender.last_name}"%>:</p>
        <p><%= comment.content %></p>
      </div>
      <div>
        <%= link_to "modifier commentaire", edit_comment_path(comment) %>
      </div>
    </div>
  <% end %>
</div>


